{% extends "base.html" %} 
{% block title %}Malware Prediction{% endblock %}
{% block content%}
<h1 style="margin-top:50px ; margin-bottom: 30px;" align="center">Malware Prediction</h1>

<form method=post action="/" enctype=multipart/form-data>
  <!-- 
  Choose a new file:  <input type="file" name="file"> 
  <input type="submit" value="submit">
  -->
  
  <div class="custom-file">
    <input type="file" class="custom-file-input" name="file" id="customFile" accept=".csv">
    <label class="custom-file-label" for="customFile">Choose a CSV file</label>
  </div>

  <br/> <br/>

  <button type="submit" class="btn btn-primary mb-2">Submit</button>

</form>

<br />

<!-- <button onclick = "display_image('', 1500, 800, 'Generated Graph');" id="my_image">Generate analysis</button> -->

<!-- <button onclick = "refresh_image();">Refreh image</button> -->


{% if isGraphCreated %}
<div align="center">
  <img src="{{ url_for('static', filename='output.png') }}" alt="Dashboard" id="my_image" width="1140"/>
</div>
{% endif %}

<script>

  function upload() {

    const fileUploader = document.getElementById('file-uploader');

    fileUploader.addEventListener('change', (event) => {
      
      console.log("Done")
      
      const files = event.target.files;
      
      console.log('files', files);
      
      console.log(files[0]);

      refresh_image( );
    
    });

  }
  
  function refresh_image( ) { 

    var timestamp = new Date().getTime();     
     
    var imageElement = document.getElementById("my_image");     
     
    imageElement.src = "{{ url_for('static', filename='output.png') }}" + "?t=" + timestamp;

  }
  
</script>

{% endblock %}